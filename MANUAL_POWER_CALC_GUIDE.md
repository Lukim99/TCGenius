# 수동 덱파워 측정 시스템 가이드

## 📋 개요

AI(LLM)를 사용하지 않고 순수 코드로 덱파워를 계산하는 시스템입니다.
모든 카드 능력을 코드로 구현하여 완벽한 일관성과 투명성을 보장합니다.

## 🎮 사용 방법

### 1. 명령어 입력
```
/TCGenius 수동덱파워측정 콘텐츠덱1
/TCGenius 수동덱파워측정 콘텐츠덱2
/TCGenius 수동덱파워측정 골드덱
```

### 2. 덱 구성 확인
시스템이 현재 덱의 카드 목록과 각 카드의 능력을 표시합니다.

### 3. 능력 적용 순서 입력
카드 번호를 공백으로 구분하여 입력합니다.
```
예시: 2 5 4 3 1
→ 2번 카드 능력부터 적용, 마지막에 1번 카드 능력 적용
```

### 4. 결과 확인
계산 과정과 최종 결과가 표시됩니다.

## 🎯 현재 구현된 능력

### ✅ 즉시 적용 능력 (추가 입력 불필요)

1. **단일 파워 증가**
   - 자기 자신의 파워에 고정값 추가
   - 예: 파워 +1000

2. **단일 파워 증가%**
   - 자기 자신의 파워에 퍼센트 증가
   - 예: 파워 +15%

3. **전체 덱 파워 증가**
   - 모든 카드에 고정값 추가
   - 예: 모든 카드 파워 +500

4. **전체 덱 파워 증가%**
   - 전역 파워 배율 증가
   - 예: 전체 덱 파워 +10%

5. **데일리 골드 증가** (골드덱만)
   - 자기 자신의 골드에 고정값 추가
   - 예: 골드 +10000

6. **데일리 골드 증가%** (골드덱만)
   - 자기 자신의 골드에 퍼센트 증가
   - 예: 골드 +20%

7. **전체 덱 골드 증가%** (골드덱만)
   - 전역 골드 배율 증가
   - 예: 전체 덱 골드 +15%

### ✅ 조건부 능력 (자동 판단)

8. **덱에 X가 있으면 Y**
   - 덱에 특정 카드가 있으면 효과 발동
   - 예: 덱에 카드 ID 123이 있으면 파워 +1000

9. **X 등급 카드가 있으면 Y**
   - 덱에 특정 등급 카드가 있으면 효과 발동
   - 예: 덱에 전설 카드가 있으면 파워 +10%

10. **X 등급 카드 N장당 Y**
    - 특정 등급 카드 개수에 비례하여 효과 적용
    - 예: 전설 카드 1장당 파워 +500

11. **특정 카드 N장당 Y**
    - 특정 카드 개수에 비례하여 효과 적용
    - 예: 카드 ID 123이 1장당 파워 +5%

12. **이 카드가 N번째면 Y**
    - 덱 내 위치에 따라 효과 발동
    - 예: 이 카드가 1번째면 전체 덱 파워 +15%

13. **X 카드가 있으면 Y**
    - "덱에 X가 있으면 Y"와 동일

### ⚠️ 대상 선택 필요 (현재 버전에서는 스킵)

- **다른 카드 1장 파워 증가**
- **다른 카드 1장 파워 증가%**

→ 향후 대화형 입력으로 대상 선택 가능하도록 구현 예정

### 🚧 미구현 능력

- 특수 능력 (파워 교환, 능력 복사 등)

## 📊 계산 예시

### 입력
```
덱 구성:
1. [전설]화염마법사 - 단일 파워 증가% (15%)
2. [영웅]빛의기사 - 전체 덱 파워 증가% (10%)
3. [희귀]숲의수호자 - 단일 파워 증가 (500)
4. [영웅]어둠의암살자 - 단일 파워 증가% (20%)
5. [전설]시간의마법사 - 전체 덱 파워 증가% (8%)

능력 적용 순서: 2 5 1 3 4
```

### 출력
```
📍 카드 2: [빛의기사] - 전체 덱 파워 증가%
  └─ 전체 덱 파워 배율 100.0% → 110.0% (+10%)

📍 카드 5: [시간의마법사] - 전체 덱 파워 증가%
  └─ 전체 덱 파워 배율 110.0% → 118.8% (+8%)

📍 카드 1: [화염마법사] - 단일 파워 증가%
  └─ [화염마법사] 파워 5000 → 5750 (+15%, +750)

📍 카드 3: [숲의수호자] - 단일 파워 증가
  └─ [숲의수호자] 파워 3000 → 3500 (+500)

📍 카드 4: [어둠의암살자] - 단일 파워 증가%
  └─ [어둠의암살자] 파워 4500 → 5400 (+20%, +900)

💪 최종 덱 파워: 28,374
```

### 조건부 능력 예시
```
덱 구성:
1. [전설]드래곤마스터 - X 등급 카드 N장당 Y
   조건: 전설 카드 1장당
   효과: 단일 파워 증가 +1000
   
2. [영웅]성기사 - 덱에 X가 있으면 Y
   조건: 카드 ID 456 존재 시
   효과: 전체 덱 파워 증가% +12%
   
3. [전설]시간마법사 - 이 카드가 N번째면 Y
   조건: 1번째 카드
   효과: 전체 덱 파워 증가% +20%

적용 순서: 3 1 2
```

### 출력
```
📍 카드 3: [시간마법사] - 이 카드가 N번째면 Y
  └─ ❌ 조건 미충족: 이 카드는 3번째 (요구: 1번째)

📍 카드 1: [드래곤마스터] - X 등급 카드 N장당 Y
  └─ ✅ 조건 충족: 전설 등급 카드 2장 → 2회 적용
  └─ [드래곤마스터] 파워 8000 → 9000 (+1000)
  └─ [드래곤마스터] 파워 9000 → 10000 (+1000)

📍 카드 2: [성기사] - 덱에 X가 있으면 Y
  └─ ✅ 조건 충족: 덱에 카드 ID 456 존재
  └─ 전체 덱 파워 배율 100.0% → 112.0% (+12%)

💪 최종 덱 파워: 30,240
```

## 🔧 기술 구조

### PowerCalculationState 클래스
```javascript
- deck: 원본 덱 (카드 ID 배열)
- cards: 파싱된 카드 객체들
- cardPowers: 각 카드의 현재 파워
- cardGolds: 각 카드의 현재 골드
- globalMultipliers: 전역 배율 {power, gold}
- appliedAbilities: 적용된 능력 로그
```

### 능력 핸들러 시스템
```javascript
abilityHandlers = {
    "단일 파워 증가": (state, cardIdx, ability) => { ... },
    "전체 덱 파워 증가%": (state, cardIdx, ability) => { ... },
    // ...
}
```

## 🚀 향후 개발 계획

### Phase 2: 대상 선택 기능
- 대화형 입력으로 대상 카드 선택
- "다른 카드 1장" 능력 구현

### Phase 3: 조건부 능력
- "덱에 X가 있으면 Y" 자동 판단
- "X 등급 카드 N장당 Y" 계산

### Phase 4: 특수 능력
- 파워 교환
- 능력 복사
- 복잡한 조합 효과

### Phase 5: UI 개선
- 단계별 계산 과정 시각화
- 되돌리기 기능
- 저장/불러오기

## 💡 장단점

### 장점 ✅
- **완벽한 일관성**: 같은 입력 = 같은 결과
- **투명성**: 모든 계산 과정 추적 가능
- **비용 절감**: AI API 비용 제로
- **즉각 응답**: 네트워크 지연 없음
- **오프라인 가능**: 인터넷 없이도 작동

### 단점 ⚠️
- **높은 개발 비용**: 모든 능력 일일이 구현 필요
- **유지보수 부담**: 새 카드 추가 시 코드 수정
- **복잡한 UX**: 여러 번 입력 필요
- **유연성 부족**: 새로운 조합 효과 대응 어려움

## 📞 문의

시스템 개선 제안이나 버그 리포트는 관리자에게 연락해주세요.
